# SLD DIY 后端上游服务器配置
# 用于蓝绿部署切换

# Node.js 后端上游
upstream backend_nodejs {
    server backend:9001 max_fails=3 fail_timeout=30s;
}

# Java 后端上游
upstream backend_java {
    server backend-java:9002 max_fails=3 fail_timeout=30s;
}

# 当前激活的后端
# 切换时修改此处配置，然后 reload nginx
upstream backend_active {
    # === 切换开关 ===
    # 使用 Node.js 后端时取消下面这行的注释，注释掉 Java 那行
    # server backend:9001;

    # 使用 Java 后端时取消下面这行的注释，注释掉 Node.js 那行
    server backend-java:9002;
}

